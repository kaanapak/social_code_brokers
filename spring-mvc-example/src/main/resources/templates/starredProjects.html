<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <title>Starred Projects</title>
    <link rel="stylesheet" href="../static/mainPage.css" />
    <script th:inline="javascript">
        const splitByPunctuations = (str = '') => {
            let res = [];
            res = str.split('*');
            for(let i = 0; i < res.length; i++){
                res[i] = res[i].split('|');
            };
            return res;
        };
        username=[[${user.getUsername()}]]
        starred_list=splitByPunctuations([[${user.toStringStarredRepos()}]]);
        function sortAlphabetically() {
            starred_list.sort((a, b) => {
                return a.item - b.item;
            });
            return starred_list
        }
        function sortLastAdded() {
             starred_list.sort((a, b) => {
                return a.time - b.time;
            });
            return starred_list
        }
        function sortScore() {
            starred_list.sort((a, b) => {
                return a.score - b.score;
            });
            return starred_list
        }

        function gengrid()
        {
            var i,x
            for(i=0;i<starred_list.length;i++)
            {
                x=x+"<p>repo: "+starred_list[i][3]+"  repo id: "+starred_list[i][2]+"</p>"
                x=x+"<p>language: "+starred_list[i][1]+"  date: "+starred_list[i][0]+"</p>"
                 x=x+"<form method=post action=/starredProjects >"
                x=x+"<input type='hidden' name='username' value="+username+" >"

                    x=x+"<input type='hidden' name='IsRemoveStar' value='1' >"
                    x=x+"<input type='hidden' name='StarredId' value="+starred_list[i][2]+" >"
                    x=x+"<input type=submit value='Remove Star'>"


                x=x+"</form>"
                x=x+"<p>------------------------------------------------------------------</p>"
            }
            document.getElementById("demo").innerHTML = x;
        }
        window.onload = function () {
            gengrid();
        }
    </script>
    <link rel="stylesheet" href="./../static/css/mainPage.css" />
</head>

<body style="background-image: url(https://i.pinimg.com/736x/8d/cd/b5/8dcdb56e3001ea29f34a30a5a5cfb631.jpg)">
    <div>
        <div class="navbar">
            <ul>
                <form method="post" action="/mainPage" >
                    <input type='hidden' name='username' th:value="${user.getUsername()}" >
                    <input type="submit" value="Home">
                </form>
                <form method="post" action="/followings" >
                    <input type='hidden' name='username' th:value="${user.getUsername()}" >
                    <input type="submit" value="Following Users">
                </form>
                <form method="post" action="/starredProjects">
                    <input type='hidden' name='username' th:value="${user.getUsername()}" >
                    <input type="submit" value="Starred Projects">
                </form>
                <li><button id="invite">Invite User</button></li>
                <li style="float: right"><a>Welcome <script>document.write(username)</script></a></li>
            </ul>
        </div>
            <div class="search">
                <input type="text" class="searchTerm" placeholder="Search user">
                <button onclick="" type="submit" class="searchButton">Search User</button>
            </div>
            <div class="filterContainer">
                <h3>Filters:</h3>
                <button type="submit" onclick="sortAlphabetically()" class="filterButton">Alphabetically</button>
                <button type="submit" onclick="sortLastAdded()" class="filterButton">Last Added</button>
                <button type="submit" onclick="sortScore()" class="filterButton">Score</button>
            </div>
            <div class="projectContainer">
                <div id="demo"></div>
            </div>
        </div>
    </div>
</body>

</html>